<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Article Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css" rel="stylesheet">
    <style>
        .loading {
            display: none;
        }
        .result {
            display: none;
        }
        .article-container {
            background: #1e1e1e;
            border-radius: 8px;
            padding: 40px;
            margin: 20px auto;
            color: #d4d4d4;
            font-family: 'Consolas', 'Monaco', monospace;
            white-space: pre-wrap;
            line-height: 1.5;
            max-width: 800px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .article-header {
            color: #569cd6;
            margin-bottom: 30px;
            text-align: center;
        }
        .article-content {
            margin-bottom: 30px;
            padding: 0 20px;
        }
        .code-block {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            margin: 30px 20px;
            position: relative;
        }
        .code-copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #569cd6;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .code-block:hover .code-copy-btn {
            opacity: 1;
        }
        .code-copy-btn:hover {
            background: #444;
        }
        .code-copy-btn.copied {
            background: #4ec9b0;
        }
        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #333;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        .copy-button:hover {
            background: #444;
        }
        .result-container {
            position: relative;
        }
        .metrics {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            margin: 30px 20px;
            color: #d4d4d4;
        }
        .metrics h4 {
            color: #569cd6;
            margin-bottom: 15px;
            text-align: center;
        }
        .metrics-item {
            margin: 10px 0;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .topic-input {
            font-size: 1.2rem;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #569cd6;
            background: #1e1e1e;
            color: #d4d4d4;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            display: block;
        }
        .topic-input:focus {
            outline: none;
            border-color: #4ec9b0;
            box-shadow: 0 0 10px rgba(78, 201, 176, 0.3);
        }
        .generate-btn {
            background: #569cd6;
            border: none;
            padding: 12px 30px;
            font-size: 1.1rem;
            margin-top: 20px;
            transition: all 0.3s ease;
        }
        .generate-btn:hover {
            background: #4ec9b0;
            transform: translateY(-2px);
        }
        .loading-text {
            font-size: 1.2rem;
            margin-top: 20px;
            color: #569cd6;
        }
        pre {
            margin: 0;
            padding: 0;
        }
        code {
            font-family: 'Consolas', 'Monaco', monospace;
        }
        .diagram-container {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            overflow-x: auto;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .diagram-container:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .diagram-content {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            margin: 0;
            text-align: center;
        }
        
        .diagram-content img {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .diagram-content img:hover {
            transform: scale(1.02);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .diagram-caption {
            color: #d4d4d4;
            font-size: 0.9em;
            margin-top: 10px;
            text-align: center;
            font-style: italic;
        }
        
        .mermaid {
            background: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            margin: 0;
        }
        
        .mermaid svg {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        
        .mermaid .node rect,
        .mermaid .node circle,
        .mermaid .node ellipse,
        .mermaid .node polygon {
            fill: #2d2d2d;
            stroke: #569cd6;
            stroke-width: 2px;
        }
        
        .mermaid .node text {
            fill: #d4d4d4;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        
        .mermaid .edgePath .path {
            stroke: #569cd6;
            stroke-width: 2px;
        }
        
        .mermaid .edgeLabel {
            background-color: #2d2d2d;
            color: #d4d4d4;
        }
        
        .mermaid .cluster rect {
            fill: #1e1e1e;
            stroke: #569cd6;
            stroke-width: 2px;
        }
        
        .mermaid .cluster text {
            fill: #569cd6;
        }
        .meta-description {
            background-color: #1a1a1a;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            border-left: 4px solid #4CAF50;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .meta-description:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .meta-title {
            color: #4CAF50;
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .meta-content {
            color: #e0e0e0;
            line-height: 1.6;
            font-size: 1.1rem;
        }
        .seo-tools {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        .seo-tool-card {
            background-color: #1a1a1a;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #2196F3;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .seo-tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .seo-tool-title {
            color: #2196F3;
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .seo-tool-content {
            color: #e0e0e0;
            line-height: 1.6;
        }
        .metrics-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        .metric-card {
            background-color: #1a1a1a;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            border-top: 4px solid #FF9800;
        }
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            color: #FF9800;
            margin-bottom: 0.5rem;
        }
        .metric-label {
            color: #e0e0e0;
            font-size: 1.1rem;
        }
        .blog-heading {
            color: #569cd6;
            margin: 40px 0 20px;
            font-size: 2em;
            display: flex;
            align-items: center;
            gap: 10px;
            padding-left: 20px;
            border-left: 4px solid #569cd6;
        }
        
        .blog-heading .emoji {
            font-size: 1.2em;
            margin-right: 10px;
        }
        
        .blog-heading .heading-text {
            font-weight: bold;
        }
        
        .blog-paragraph {
            margin: 20px 0;
            line-height: 1.8;
            color: #d4d4d4;
            font-size: 1.1em;
            padding: 0 20px;
            text-align: justify;
        }
        
        .blog-bullet {
            margin: 15px 0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 0 20px;
        }
        
        .blog-bullet .bullet-point {
            color: #569cd6;
            font-size: 1.2em;
            margin-top: 5px;
        }
        
        .blog-bullet .bullet-text {
            color: #d4d4d4;
            line-height: 1.6;
            flex: 1;
        }
        
        .table-container {
            margin: 30px 0;
            overflow-x: auto;
            padding: 0 20px;
        }
        
        .blog-table {
            width: 100%;
            border-collapse: collapse;
            background: #2d2d2d;
            border-radius: 8px;
            overflow: hidden;
            margin: 0 auto;
        }
        
        .blog-table th,
        .blog-table td {
            padding: 15px;
            border: 1px solid #444;
            color: #d4d4d4;
            text-align: left;
        }
        
        .blog-table th {
            background: #1e1e1e;
            color: #569cd6;
            font-weight: bold;
            text-align: center;
        }
        
        .blog-table tr:hover {
            background: #333;
        }
        
        .highlight-box {
            background: #2d2d2d;
            border-left: 4px solid #569cd6;
            padding: 20px;
            margin: 30px 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .highlight-box .highlight-content {
            color: #d4d4d4;
            line-height: 1.6;
            padding: 0 10px;
        }
        
        .code-block pre {
            margin: 0;
            padding: 0;
            overflow-x: auto;
        }
        
        .code-block code {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }
    </style>
</head>
<body class="bg-dark text-light">
    <div class="container mt-5">
        <h1 class="text-center mb-4">AI Article Generator</h1>
        <div class="row justify-content-center">
            <div class="col-md-8 text-center">
                <form id="articleForm">
                    <input type="text" 
                           class="topic-input" 
                           id="topic" 
                           name="topic" 
                           placeholder="Enter a topic and let AI do the rest..." 
                           required>
                    <button type="submit" class="btn generate-btn">Generate Article</button>
                </form>

                <div class="loading mt-4 text-center">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="loading-text">AI is researching and writing your article...</p>
                </div>

                <div class="result mt-4">
                    <div class="result-container">
                        <button class="copy-button" onclick="copyArticle()">Copy Article</button>
                        <div class="article-container">
                            <div class="article-header">
                                <h2 id="articleTitle"></h2>
                                <p id="articleMeta"></p>
                            </div>
                            <div class="article-content" id="articleContent"></div>
                        </div>
                        <div class="metrics">
                            <h4>Article Metrics</h4>
                            <div id="articleMetrics"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                'primaryColor': '#569cd6',
                'primaryTextColor': '#d4d4d4',
                'primaryBorderColor': '#444',
                'lineColor': '#569cd6',
                'secondaryColor': '#2d2d2d',
                'tertiaryColor': '#1e1e1e',
                'fontFamily': 'Consolas, Monaco, monospace',
                'fontSize': '16px',
                'nodeBorder': '#569cd6',
                'nodeTextColor': '#d4d4d4',
                'mainBkg': '#2d2d2d',
                'errorBkgColor': '#ff6b6b',
                'errorTextColor': '#d4d4d4'
            },
            flowchart: {
                htmlLabels: true,
                curve: 'basis',
                useMaxWidth: true
            },
            sequence: {
                diagramMarginX: 50,
                diagramMarginY: 10,
                actorMargin: 50,
                width: 150,
                height: 65,
                boxMargin: 10,
                boxTextMargin: 5,
                noteMargin: 10,
                messageMargin: 35
            }
        });

        // Function to generate flow diagram
        async function generateFlowDiagram(steps) {
            try {
                const response = await fetch('/generate-diagram', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        steps: steps,
                        settings: {
                            directory_path: "features/echo_deepak/echodeepak_flow_images",
                            domain: "https://app.ai.hidevs.xyz",
                            image_paths: [
                                "features/echo_deepak/utils/logos/general/ai_engine.png",
                                "features/echo_deepak/utils/logos/general/chunking.png",
                                "features/echo_deepak/utils/logos/general/data_cleaning.png",
                                "features/echo_deepak/utils/logos/general/embedding_model.png",
                                "features/echo_deepak/utils/logos/general/json_output.png",
                                "features/echo_deepak/utils/logos/general/knowledge_base.png",
                                "features/echo_deepak/utils/logos/general/memory.png",
                                "features/echo_deepak/utils/logos/general/data_collection.png",
                                "features/echo_deepak/utils/logos/general/prompt.png",
                                "features/echo_deepak/utils/logos/general/rest_api.png",
                                "features/echo_deepak/utils/logos/general/retrieve.png",
                                "features/echo_deepak/utils/logos/general/optimization.png",
                                "features/echo_deepak/utils/logos/general/ui.png"
                            ]
                        }
                    })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to generate diagram');
                }
                
                const data = await response.json();
                return data.image_url;
            } catch (error) {
                console.error('Error generating diagram:', error);
                return null;
            }
        }

        // Function to render diagram in article
        function renderDiagram(imageUrl) {
            return `
                <div class="diagram-container">
                    <div class="diagram-content">
                        <img src="${imageUrl}" 
                             alt="Flow Diagram" 
                        >
                    </div>
                    <div class="diagram-caption">Click to zoom</div>
                </div>
            `;
        }

        document.getElementById('articleForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const form = e.target;
            const loading = document.querySelector('.loading');
            const result = document.querySelector('.result');
            const articleContent = document.getElementById('articleContent');
            const articleTitle = document.getElementById('articleTitle');
            const articleMeta = document.getElementById('articleMeta');
            const articleMetrics = document.getElementById('articleMetrics');
            
            loading.style.display = 'block';
            result.style.display = 'none';
            
            const formData = {
                topic: form.topic.value,
                links: [],
                include_code: true,
                include_diagrams: true,
                target_word_count: 2000,
                style: {
                    use_emojis: true,
                    include_technical_depth: true,
                    format: "blog-post",
                    include_code_examples: true,
                    include_practical_implementation: true,
                    target_audience: "general",
                    writing_style: "conversational",
                    sections: [
                        "üåü Introduction",
                        "üéØ What's the Big Deal?",
                        "‚ú® The Magic Formula",
                        "üß† The Secret Sauce",
                        "üìù From Draft to Traffic Magnet",
                        "‚ö° Workflow At A Glance",
                        "ü•á Pro Tips",
                        "üìã Executive Summary"
                    ],
                    structure: {
                        introduction: {
                            length: "2-3 paragraphs",
                            style: "hook with context",
                            include_author: true,
                            include_date: true,
                            include_meta_description: true,
                            meta_description: "Our AI agents integrate with Ahrefs, Semrush, Search Console & more to automate SEO workflows, create content, and optimize for both Google and AI search engines like ChatGPT‚Äîcutting costs by 70%+ while boosting your organic revenue."
                        },
                        main_sections: {
                            format: "emoji-headers with bullet points",
                            include_tables: true,
                            include_tips: true,
                            include_analogies: true,
                            seo_tools: [
                                "Ahrefs Integration",
                                "Semrush Automation",
                                "Search Console Analytics",
                                "ChatGPT Optimization",
                                "Content Creation",
                                "Cost Reduction",
                                "Revenue Boost"
                            ]
                        },
                        conclusion: {
                            format: "bullet points",
                            include_call_to_action: true,
                            include_next_steps: true
                        }
                    },
                    formatting: {
                        use_emojis: true,
                        include_tables: true,
                        include_highlight_boxes: true,
                        include_quotes: true,
                        include_metrics: true,
                        include_tips: true
                    },
                    seo: {
                        include_meta_description: true,
                        include_keywords: true,
                        include_structured_data: true,
                        include_schema_markup: true,
                        meta_description: "Our AI agents integrate with Ahrefs, Semrush, Search Console & more to automate SEO workflows, create content, and optimize for both Google and AI search engines like ChatGPT‚Äîcutting costs by 70%+ while boosting your organic revenue.",
                        keywords: [
                            "AI agents",
                            "SEO automation",
                            "Ahrefs",
                            "Semrush",
                            "Search Console",
                            "ChatGPT",
                            "content creation",
                            "cost reduction",
                            "revenue boost"
                        ]
                    }
                }
            };
            
            try {
                const response = await fetch('/generate-article', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                if (!response.ok) {
                    throw new Error('Failed to generate article');
                }
                
                const data = await response.json();
                
                // Set title and meta
                articleTitle.textContent = data.article.split('\n')[0].replace('#', '').trim();
                articleMeta.textContent = `Generated on ${new Date().toLocaleString()}`;
                
                // Format and display content
                const formattedContent = formatArticle(data.article);
                articleContent.innerHTML = formattedContent;
                
                // Generate and insert flow diagram if needed
                if (data.include_diagram) {
                    const imageUrl = await generateFlowDiagram(data.diagram_steps);
                    if (imageUrl) {
                        const diagramSection = document.createElement('div');
                        diagramSection.innerHTML = renderDiagram(imageUrl);
                        articleContent.insertBefore(diagramSection, articleContent.firstChild);
                    }
                }
                
                // Display metrics
                if (data.metrics) {
                    articleMetrics.innerHTML = `
                        <div class="metrics-item">Word Count: ${data.metrics.content_metrics.word_count}</div>
                        <div class="metrics-item">Reading Time: ${Math.ceil(data.metrics.content_metrics.reading_time_minutes)} minutes</div>
                        <div class="metrics-item">Structure Score: ${(data.metrics.content_metrics.structure_score * 100).toFixed(1)}%</div>
                    `;
                }
                
                // Apply syntax highlighting
                document.querySelectorAll('pre code').forEach((block) => {
                    hljs.highlightElement(block);
                });
                
                // Initialize Mermaid diagrams
                mermaid.init(undefined, '.mermaid');
                
                result.style.display = 'block';
            } catch (error) {
                alert('Error generating article: ' + error.message);
            } finally {
                loading.style.display = 'none';
            }
        });

        function formatArticle(content) {
            const lines = content.split('\n');
            let formattedContent = '';
            let inCodeBlock = false;
            let currentCodeBlock = '';
            let currentLanguage = '';
            let inTable = false;
            let currentTable = '';
            let inHighlightBox = false;
            let currentHighlightBox = '';
            let inMetaDescription = false;
            
            for (let line of lines) {
                if (line.startsWith('Meta Description:')) {
                    inMetaDescription = true;
                    formattedContent += `
                        <div class="meta-description">
                            <div class="meta-title">
                                <span class="emoji">üìù</span>
                                Meta Description
                            </div>
                            <div class="meta-content">
                                ${line.replace('Meta Description:', '').trim()}
                            </div>
                        </div>
                    `;
                    continue;
                }
                
                if (line.startsWith('```')) {
                    if (!inCodeBlock) {
                        inCodeBlock = true;
                        currentLanguage = line.replace('```', '').trim();
                        currentCodeBlock = '';
                    } else {
                        inCodeBlock = false;
                        formattedContent += `
                            <div class="code-block">
                                <button class="code-copy-btn" onclick="copyCode(this)">Copy</button>
                                <pre><code class="language-${currentLanguage}">${currentCodeBlock.trim()}</code></pre>
                            </div>
                        `;
                    }
                } else if (inCodeBlock) {
                    currentCodeBlock += line + '\n';
                } else if (line.startsWith('|')) {
                    if (!inTable) {
                        inTable = true;
                        currentTable = line;
                    } else {
                        currentTable += '\n' + line;
                        if (line.trim().endsWith('|')) {
                            inTable = false;
                            formattedContent += `
                                <div class="table-container">
                                    <table class="blog-table">
                                        ${formatTable(currentTable)}
                                    </table>
                                </div>
                            `;
                        }
                    }
                } else if (line.startsWith('>')) {
                    if (!inHighlightBox) {
                        inHighlightBox = true;
                        currentHighlightBox = line.substring(1).trim();
                    } else {
                        currentHighlightBox += '\n' + line.substring(1).trim();
                        if (line.trim() === '') {
                            inHighlightBox = false;
                            formattedContent += `
                                <div class="highlight-box">
                                    <div class="highlight-content">
                                        ${currentHighlightBox}
                                    </div>
                                </div>
                            `;
                        }
                    }
                } else if (line.startsWith('#')) {
                    const level = line.match(/^#+/)[0].length;
                    const text = line.replace(/^#+\s*/, '');
                    const emojiMatch = text.match(/^(\p{Emoji}+)\s*(.+)/u);
                    
                    if (emojiMatch) {
                        formattedContent += `
                            <h${level} class="blog-heading">
                                <span class="emoji">${emojiMatch[1]}</span>
                                <span class="heading-text">${emojiMatch[2]}</span>
                            </h${level}>
                        `;
                    } else {
                        formattedContent += `<h${level} class="blog-heading">${text}</h${level}>`;
                    }
                } else if (line.startsWith('* ')) {
                    formattedContent += `
                        <div class="blog-bullet">
                            <span class="bullet-point">‚Ä¢</span>
                            <span class="bullet-text">${line.substring(2)}</span>
                        </div>
                    `;
                } else if (line.trim() === '') {
                    formattedContent += '<br>';
                } else {
                    formattedContent += `
                        <div class="blog-paragraph">
                            ${line}
                        </div>
                    `;
                }
            }
            
            return formattedContent;
        }

        function formatTable(tableText) {
            const rows = tableText.split('\n');
            let html = '';
            
            rows.forEach((row, index) => {
                const cells = row.split('|').filter(cell => cell.trim());
                if (cells.length > 0) {
                    if (index === 0) {
                        html += '<thead><tr>';
                        cells.forEach(cell => {
                            html += `<th>${cell.trim()}</th>`;
                        });
                        html += '</tr></thead><tbody>';
                    } else {
                        html += '<tr>';
                        cells.forEach(cell => {
                            html += `<td>${cell.trim()}</td>`;
                        });
                        html += '</tr>';
                    }
                }
            });
            
            return html + '</tbody>';
        }

        function copyCode(button) {
            const codeBlock = button.parentElement;
            const code = codeBlock.querySelector('code').textContent;
            
            navigator.clipboard.writeText(code).then(() => {
                button.textContent = 'Copied!';
                button.classList.add('copied');
                setTimeout(() => {
                    button.textContent = 'Copy';
                    button.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy code: ', err);
            });
        }

        function copyArticle() {
            const articleContent = document.getElementById('articleContent').textContent;
            navigator.clipboard.writeText(articleContent).then(() => {
                alert('Article copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy article: ', err);
            });
        }
    </script>
</body>
</html> 